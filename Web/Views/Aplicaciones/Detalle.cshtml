@model KO.Web.Models.Aplicaciones.AplicacionViewModel

@section scripts{
    <script type="text/javascript" src="~/js/KO/aplicaciones/aplicaciones-detalle.js"></script>
    <script type="text/javascript">
        vueAppParams.data.model =@Html.Raw(Model.ToJsonModel())
    </script>
}

<v-row v-if="breadcrums.length > 0" class="breadcrum-row">
    <v-breadcrumbs :items="breadcrums">
        <template v-slot:item="{ item }">
            <v-breadcrumbs-item :href="item.href"
                                :disabled="item.disabled">
                <span style="font-weight: bold;"> {{  item.text.toUpperCase() }}</span>
            </v-breadcrumbs-item>
        </template>
    </v-breadcrumbs>

</v-row>
<template>
    <v-container class="mt-8">
        <v-row no-gutters
               style="flex-wrap: nowrap;">
            <v-col cols="6"
                   class="flex-grow-1 flex-shrink-0 mx-auto">
                <v-card class="notebook">
                    <template>
                        <v-form ref="form" lazy-validation>
                            <v-container>
                                <v-row class="mt-4 ml-4 mr-4 mb-0">
                                    <v-col class="col-lg-5">
                                        <v-menu ref="menuFecha"
                                                v-model="menuFecha"
                                                :close-on-content-click="true"
                                                transition="scale-transition"
                                                offset-y
                                                min-width="auto">
                                            <template v-slot:activator="{ on, attrs }">
                                                <v-text-field :value="fecha"
                                                              :label="jsglobals.FechaAplicacion"
                                                              prepend-icon="mdi-calendar"
                                                              v-bind="attrs"
                                                              v-on="on"></v-text-field>
                                            </template>
                                            <v-date-picker v-model="fecha"
                                                           no-title
                                                           :max="hoy()"
                                                           locale="es-419"
                                                           scrollable>
                                            </v-date-picker>
                                        </v-menu>
                                    </v-col>
                                    <v-col cols="12" class="d-inline-block mt-1">
                                        <v-row>
                                            <v-col lg="10" class="mr-10">
                                                <v-autocomplete v-model="model.IdPaciente"
                                                                :items="pacientes"
                                                                item-value="id"
                                                                :label="jsglobals.Paciente"
                                                                :loading="loadingPacientes"
                                                                :no-data-text="jsglobals.SinDatos">
                                                    <template v-slot:item="{item}">
                                                        <span>{{ item.apellido }}, {{ item.nombre}}</span>
                                                    </template>
                                                    <template v-slot:selection="{item}">
                                                        <span>{{ item.apellido }}, {{ item.nombre}}</span>
                                                    </template>
                                                </v-autocomplete>
                                            </v-col>
                                            @*<v-col lg="1">
                                                <v-tooltip left>
                                                    <template v-slot:activator="{ on, attrs }">
                                                        <v-btn v-bind="attrs"
                                                               v-on="on"
                                                               small
                                                               v-on:click="nuevoPaciente"
                                                               color="primary"
                                                               elevation="2"
                                                               class="mt-3">
                                                            <v-icon>mdi-plus</v-icon>
                                                        </v-btn>
                                                    </template>
                                                    <span>{{jsglobals.Nuevo}} {{jsglobals.Paciente}}</span>
                                                </v-tooltip>
                                            </v-col>*@
                                        </v-row>
                                    </v-col>
                                    <v-col cols="12" class="d-inline-block">
                                        <v-row>
                                            <v-col lg="10" class="mr-10">
                                                <v-autocomplete v-model="model.IdMedico"
                                                                :items="medicos"
                                                                item-value="matricula"
                                                                :label="jsglobals.Medico"
                                                                :no-data-text="jsglobals.SinDatos"
                                                                :loading="loadingMedicos">
                                                    <template v-slot:item="{item}">
                                                        <span>{{ item.apellido }}, {{ item.nombre}}</span>
                                                    </template>
                                                    <template v-slot:selection="{item}">
                                                        <span>{{ item.apellido }}, {{ item.nombre}}</span>
                                                    </template>
                                                </v-autocomplete>
                                            </v-col>
                                            @*<v-col lg="1">
                                                <v-tooltip left>
                                                    <template v-slot:activator="{ on, attrs }">
                                                        <v-btn v-bind="attrs"
                                                               v-on="on"
                                                               small
                                                               v-on:click="nuevoMedico"
                                                               color="primary"
                                                               elevation="2"
                                                               class="mt-3">
                                                            <v-icon>mdi-plus</v-icon>
                                                        </v-btn>
                                                    </template>
                                                    <span>{{jsglobals.Nuevo}} {{jsglobals.Medico}}</span>
                                                </v-tooltip>
                                            </v-col>*@
                                        </v-row>
                                    </v-col>
                                    <v-col cols="12" class="d-inline-block mt-4">
                                        <v-row>
                                            <v-col lg="10" class="mr-10">
                                                <v-select v-model="vacunasSeleccionadas"
                                                          :items="vacunas"
                                                          item-value="id"
                                                          multiple
                                                          chips
                                                          dense
                                                          :label="jsglobals.Vacunas"
                                                          :loading="loadingVacunas"
                                                          :no-data-text="jsglobals.SinDatos">
                                                    <template v-slot:item="{ active, item, attrs, on }">
                                                        <v-list-item v-on="on" v-bind="attrs" #default="{ active }">
                                                            <v-list-item-action>
                                                                <v-checkbox :input-value="active"></v-checkbox>
                                                            </v-list-item-action>
                                                            <v-list-item-content>
                                                                <v-list-item-title>
                                                                    <v-row no-gutters align="center">
                                                                        <span>{{ item.nombre }} - {{ item.marca }}</span>
                                                                    </v-row>
                                                                </v-list-item-title>
                                                            </v-list-item-content>
                                                        </v-list-item>
                                                    </template>
                                                    <template v-slot:selection="{item, index}">
                                                        <v-chip text-color="white" color="light-blue" class="ma-1">
                                                            <span>{{ item.nombre }} - {{ item.marca}}</span>
                                                        </v-chip>
                                                    </template>
                                                </v-select>
                                            </v-col>
                                            @*<v-col lg="1">
                                                <v-tooltip left>
                                                    <template v-slot:activator="{ on, attrs }">
                                                        <v-btn v-bind="attrs"
                                                               v-on="on"
                                                               small
                                                               v-on:click="nuevaVacuna"
                                                               color="primary"
                                                               elevation="2"
                                                               class="mt-3">
                                                            <v-icon>mdi-plus</v-icon>
                                                        </v-btn>
                                                    </template>
                                                    <span>{{jsglobals.Nueva}} {{jsglobals.Vacuna}}</span>
                                                </v-tooltip>
                                            </v-col>*@
                                        </v-row>
                                    </v-col>

                                        </v-row>
                                        <v-row class="mt-3 mb-2 mr-2">
                                            <v-col cols="12">
                                                <v-tooltip bottom>
                                                    <template v-slot:activator="{ on, attrs }">
                                                        <v-btn class="float-right"
                                                               v-bind="attrs"
                                                               v-on="on"
                                                               v-on:click="guardarAplicacion"
                                                               color="primary"
                                                               small
                                                               :disabled="submiting"
                                                               :loading="submiting"
                                                               elevation="2">
                                                            <v-icon small class="pr-1">mdi-content-save</v-icon>
                                                            {{jsglobals.Guardar}}
                                                        </v-btn>
                                                    </template>
                                                    <span>   {{jsglobals.Guardar}}</span>
                                                </v-tooltip>
                                                <v-tooltip bottom>
                                                    <template v-slot:activator="{ on, attrs }">
                                                        <v-btn class="float-right mr-3"
                                                               v-bind="attrs"
                                                               v-on="on"
                                                               v-on:click="volver()"
                                                               color="primary"
                                                               small
                                                               elevation="2"
                                                               :disabled="submiting"
                                                               :loading="submiting">
                                                            <v-icon small class="pr-1">mdi-arrow-left-circle</v-icon>
                                                            {{jsglobals.Volver}}
                                                        </v-btn>
                                                    </template>
                                                    <span>{{jsglobals.Volver}}</span>
                                                </v-tooltip>
                                            </v-col>










</v-container>
                        </v-form>
                    </template>
                </v-card>
            </v-col>
        </v-row>


    </v-container>
</template>
